{
  "title": "SFTP",
  "buildType": "docker",
  "description": "Provides file access and transfer using SSH File Transfer Protocol",
  "credentials": {
    "fields": {
      "host": {
        "viewClass": "TextFieldView",
        "label": "Host",
        "required": true,
        "placeholder": "Name of the host"
      },
      "port": {
        "viewClass": "TextFieldView",
        "label": "Port",
        "placeholder": "Port of the host",
        "note": "If no port is provided, 22 will be used"
      },
      "username": {
        "viewClass": "TextFieldView",
        "label": "User Name",
        "required": true,
        "placeholder": "Paste your SFTP user name"
      },
      "password": {
        "viewClass": "PasswordFieldView",
        "label": "Password",
        "required": true,
        "placeholder": "Paste your SFTP password"
      }
    }
  },
  "actions": {
    "upload": {
      "main": "./lib/actions/upload.js",
      "title": "Upload files from attachments.",
      "description": "Upload incoming files (attachments) to SFTP directory. Manipulation of the file names is not possible.",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar",
          "note": "Directory will be created if not exists, attachments with the same name would be overwritten"
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": false
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "result": {
              "title": "Result",
              "type": "object",
              "required": true,
              "properties": {
                "results": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "attachment": {
                        "title": "Attachment Name",
                        "type": "string",
                        "required": true
                      },
                      "uploadedOn": {
                        "title": "Uploaded on",
                        "type": "string",
                        "required": true
                      },
                      "fileName": {
                        "title": "File Name",
                        "type": "string",
                        "required": true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "delete": {
      "main": "./lib/actions/delete.js",
      "title": "Delete file",
      "description": "Delete file by name in provided path",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar"
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "id": {
              "title": "File Name",
              "type": "string",
              "required": true
            }
          }
        }
      }
    },
    "upsertFile": {
      "main": "./lib/actions/upsertFile.js",
      "title": "Upsert File",
      "description": "Given an attachment URL and a filename, store the contents of the attachment in the file.",
      "fields": {
        "updateBehavior": {
          "label": "Behavior When File Already Exists",
          "viewClass": "SelectView",
          "required": true,
          "prompt": "Select a Behavior",
          "model": {
            "error": "Throw an Error",
            "overwrite": "Overwrite the File",
            "append": "Append the File Contents"
          }
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "required": true,
          "properties": {
            "filename": {
              "title": "File Name and Path",
              "type": "string",
              "required": true
            },
            "attachmentUrl": {
              "title": "Attachment URL",
              "type": "string",
              "required": true
            },
            "encoding": {
              "title": "Encoding (defaults to null)",
              "type": "string",
              "required": false
            },
            "fileMod": {
              "title": "File Mode (i.e. read/write permissions) (defaults to 0o666 (rwx)",
              "type": "string",
              "required": false
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            },
            "size": {
              "title": "File Size",
              "type": "number",
              "required": true
            },
            "type": {
              "title": "File Type",
              "type": "string",
              "required": true
            },
            "modifyTime": {
              "title": "Last Modification Time",
              "type": "number",
              "required": true
            },
            "accessTime": {
              "title": "Last Access Time",
              "type": "number",
              "required": true
            }
          }
        }
      }
    },
    "lookupObject": {
      "main": "./lib/actions/lookupObject.js",
      "title": "Lookup file by name",
      "description": "Lookup file by name in provided path",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar"
        },
        "allowEmptyResult": {
          "viewClass": "SelectView",
          "label": "Allow Empty Result",
          "model": {
            "Yes": "Yes",
            "No": "No"
          },
          "prompt": "Allow empty result if object not found? Default: No."
        },
        "allowCriteriaToBeOmitted": {
          "viewClass": "SelectView",
          "label": "Allow File name to be Omitted",
          "model": {
            "Yes": "Yes",
            "No": "No"
          },
          "prompt": "Allow File name to be omitted? Default: No."
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string"
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            },
            "size": {
              "title": "File Size",
              "type": "number",
              "required": true
            }
          }
        }
      }
    }
  },
  "triggers": {
    "read": {
      "main": "./lib/triggers/read.js",
      "title": "Read files",
      "type": "polling",
      "description": "Will continuously poll remote SFTP location for files that match given pattern. Found files will be transferred as attachments to the next component.",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "Directory"
        },
        "pattern": {
          "viewClass": "TextFieldView",
          "label": "Pattern to Match Files",
          "required": false,
          "placeholder": "Pattern"
        }
      },
      "metadata": {
        "out": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            },
            "size": {
              "title": "File Size",
              "type": "number",
              "required": true
            }
          }
        }
      }
    },
    "pollingTrigger": {
      "main": "./lib/triggers/polling.js",
      "title": "Get new and updated files",
      "type": "polling",
      "description": "Will continuously poll remote SFTP location for files that match given pattern. Found files will be transferred as attachments to the next component.",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "Directory"
        },
        "emitBehaviour": {
          "label": "Emit Behaviour",
          "viewClass": "SelectView",
          "required": false,
          "prompt": "Default Emit Individually",
          "model": {
            "emitIndividually": "Emit Individually",
            "fetchAll": "Fetch All"
          }
        }
      },
      "metadata": {
        "out": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            },
            "size": {
              "title": "File Size",
              "type": "number",
              "required": true
            },
            "type": {
              "title": "File Type",
              "type": "string",
              "required": true
            },
            "modifyTime": {
              "title": "Last Modification Time",
              "type": "number",
              "required": true
            },
            "accessTime": {
              "title": "Last Access Time",
              "type": "number",
              "required": true
            }
          }
        }
      }
    }
  }
}
