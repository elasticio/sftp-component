{
  "title": "SFTP",
  "buildType": "docker",
  "description": "Provides file access and transfer using SSH File Transfer Protocol",
  "credentials": {
    "fields": {
      "host": {
        "viewClass": "TextFieldView",
        "label": "Host",
        "required": true,
        "placeholder": "Name of the host"
      },
      "port": {
        "viewClass": "TextFieldView",
        "label": "Port",
        "placeholder": "Port of the host",
        "note": "If no port is provided, 22 will be used"
      },
      "username": {
        "viewClass": "TextFieldView",
        "label": "User Name",
        "required": true,
        "placeholder": "Paste your SFTP user name"
      },
      "password": {
        "viewClass": "PasswordFieldView",
        "label": "Password",
        "required": true,
        "placeholder": "Paste your SFTP password"
      }
    }
  },
  "actions": {
    "upload": {
      "main": "./lib/actions/upload.js",
      "title": "Upload files",
      "description": "Upload files (attachments) to SFTP directory",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar",
          "note": "Directory will be created if not exists, attachments with the same name would be overwritten"
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": false
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "result": {
              "title": "Result",
              "type": "object",
              "required": true,
              "properties": {
                "results": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "attachment": {
                        "title": "Attachment Name",
                        "type": "string",
                        "required": true
                      },
                      "uploadedOn": {
                        "title": "Uploaded on",
                        "type": "string",
                        "required": true
                      },
                      "fileName": {
                        "title": "File Name",
                        "type": "string",
                        "required": true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "delete": {
      "main": "./lib/actions/delete.js",
      "title": "Delete file",
      "description": "Delete file by name in provided path",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar"
        }
      },
      "metadata": {
        "in": {
          "type": "object",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            }
          }
        },
        "out": {
          "type": "object",
          "properties": {
            "id": {
              "title": "File Name",
              "type": "string",
              "required": true
            }
          }
        }
      }
    },
    "lookupObjects": {
      "main": "./lib/actions/lookupFiles.js",
      "title": "Lookup Objects",
      "description": "Load list of files to attachments",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "/foo/bar"
        },
        "emitBehaviour": {
          "viewClass": "SelectView",
          "label": "Behavior",
          "required": true,
          "model": {
            "emitIndividually": "Emit Individually",
            "fetchAll": "Fetch All"
          },
          "prompt": "Choose a Behavior type"
        },
        "maxResultSize": {
          "viewClass": "TextFieldView",
          "label": "Max Result Size",
          "required": false,
          "placeholder": "Default: 250, maximum allowed number: 250. Works only with Fetch All behaviour."
        },
        "numSearchTerms": {
          "viewClass": "TextFieldView",
          "label": "Number of search terms",
          "required": false,
          "placeholder": "0"
        }
      },
      "dynamicMetadata": true
    }
  },
  "triggers": {
    "read": {
      "main": "./lib/triggers/read.js",
      "title": "Read files",
      "type": "polling",
      "description": "Will continuously poll remote SFTP location for files that match given pattern. Found files will be transferred as attachments to the next component.",
      "fields": {
        "directory": {
          "viewClass": "TextFieldView",
          "label": "Directory Name",
          "required": true,
          "placeholder": "Directory"
        },
        "pattern": {
          "viewClass": "TextFieldView",
          "label": "Pattern to Match Files",
          "required": false,
          "placeholder": "Pattern"
        }
      },
      "metadata": {
        "out": {
          "type": "objectTrigger",
          "properties": {
            "filename": {
              "title": "File Name",
              "type": "string",
              "required": true
            },
            "size": {
              "title": "File Size",
              "type": "number",
              "required": true
            }
          }
        }Trigger
      }
    }
  }
}
